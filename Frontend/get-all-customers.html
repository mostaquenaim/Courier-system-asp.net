<!DOCTYPE html>
<html lang="en-US">
<head>
    <link rel="stylesheet" href="project.css">
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.9/angular.min.js"></script>
</head>
<body ng-app="my-app" ng-controller="CustomerController">

    <div>
        <h1>Customer Details</h1>
        <table border="1">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Name</th>
                    <th>Phone Number</th>
                    <th>Address</th>
                    <th>Email</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                <tr ng-repeat="customer in customers">
                    <td>{{ customer.Id }}</td>
                    <td>{{ customer.Name }}</td>
                    <td>{{ customer.PhoneNo }}</td>
                    <td>{{ customer.Address }}</td>
                    <td>{{ customer.Email }}</td>
                    <td>
                        <button ng-click="deleteCustomer(customer.Id)">Delete</button>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>

    <script>
        angular.module('my-app', [])
            .controller('CustomerController', function ($scope, $http) {
                $scope.customers = [];


                $scope.fetchCustomers = function () {
                    $http.get('https://localhost:44324/api/customer/all')
                        .then(function success(response) {
                            $scope.customers = response.data;
                        }, function error(response) {
                            console.error('Error fetching customers:', response);
                        });
                };


                $scope.deleteCustomer = function (customerId) {
                    if (confirm('Are you sure you want to delete this customer?')) {
                        $http.delete('https://localhost:44324/api/customer/delete/' + customerId)
                            .then(function success(response) {
                                $scope.fetchCustomers(); 
                            }, function error(response) {
                                console.error('Error deleting customer:', response);
                            });
                    }
                };

                // Initial fetch of customers
                $scope.fetchCustomers();
            });
    </script>
</body>
</html>
